@model ICollection<ChatServerSignalRWithIdentity.Models.Message>

<ul>
        @foreach (var message in Model)
        {
            <li>@message</li>
        }
    </ul>

@*@{
    ViewData["Title"] = "Home Page";
    var userName = User.Identity.Name;
    var userId = Model.CallerId;
}


        @if (Model.DialogsWithFriendsList.Count != 0)
        {
         сообщения       (Model.MessagesList.Any() && 
            <div class="col-md-9" id="chat">
                <div class="row" id="rowForMessageScroll">
                    <div class="scrollbar square scrollbar-lady-lips" id="messagesBar">
                        <div class="force-overflow">

                            @if (Model?.MessagesList?.First().DialogId == @dialogId)
                                {



                            @foreach (var message in Model.MessagesList.OrderBy(m => m.CreatedUtc))
                                {
                                    string containerClass, timePosition, textAlign, contcolor, offset;
                                    if (userName == message.UserName)
                                    {
                                        containerClass = "container darker";
                                        timePosition = "time-left text-light";
                                        textAlign = "text-left text-white";
                                        contcolor = "bg-primary";
                                        offset = "col-md-6 offset-md-6";
                                    }
                                    else
                                    {
                                        containerClass = "container";
                                        timePosition = "time-left";
                                        textAlign = "text-left";
                                        contcolor = "bg-light";
                                        offset = "col-md-6";
                                    }
                                    <div class="row">
                                        <div class="@offset">
                                            <div class="@containerClass @contcolor">

                                                <p class="sender @textAlign">@message.UserName</p>
                                                <p class="@textAlign">@message.Text</p>
                                                <span class="@timePosition">@message.CreatedUtc.ToString("HH:mm")</span>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }

                        </div>
                    </div>
                </div>

            </div>


        }

        else
        {
            <h1>Let's find your friend soon</h1>
        }


@if (User.Identity.IsAuthenticated)
{
    <script>
        const userName = "@ViewBag.CurrentUserName";
    </script>
}*@


<script src="~/lib/signalr/signalr.min.js"></script>
<script src="~/lib/jquery/dist/jquery.unobtrusive-ajax.min.js"></script>
<script src="~/js/chat.js"></script>
<script src="~/js/signalrReqHandler.js"></script>

